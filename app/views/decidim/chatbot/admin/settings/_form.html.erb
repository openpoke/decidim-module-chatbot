<%= decidim_form_for(@form, url: setting_path(id: params[:id]), method: :patch, html: { class: "form-defaults form edit_setting" }) do |form| %>
  <div class="form__wrapper"
       data-controller="chatbot-settings"
       data-chatbot-settings-components-url-value="<%= components_setting_path(id: params[:id]) %>"
       data-chatbot-settings-workflow-fields-url-value="<%= workflow_fields_setting_path(id: params[:id]) %>"
       data-chatbot-settings-loading-text-value="<%= t('.loading') %>"
       data-chatbot-settings-select-component-text-value="<%= t('.select_component') %>"
       data-chatbot-settings-select-space-first-text-value="<%= t('.select_space_first') %>"
       data-chatbot-settings-configuration-for-text-value="<%= t('.configuration_for', workflow: '%{workflow}') %>">

    <div class="card pt-4">
      <div class="card-section">
        <div class="row column">
          <%= form.select :start_workflow,
              @form.available_workflows,
              { label: t(".current_workflow", provider: provider) },
              { data: { action: "change->chatbot-settings#changeWorkflow" } } %>
        </div>
      </div>
    </div>

    <div data-chatbot-settings-target="workflowConfig">
      <% if @workflow_manifest&.configurable? %>
        <div class="card">
          <div class="card-divider">
            <h2 class="card-title" data-chatbot-settings-target="workflowHeading">
              <%= t(".configuration_for", workflow: @form.workflow_display_name) %>
            </h2>
          </div>

          <div class="card-section">
            <%= render partial: @workflow_manifest.settings_partial, locals: { form: form, setting_form: @form, config: @form.config } %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="card pt-4">
      <div class="card-section">
        <div class="row column">
          <%= form.check_box :enabled, label: t(".enabled") %>
        </div>
      </div>
    </div>

    <div class="item__edit-sticky">
      <div class="item__edit-sticky-container">
        <%= form.submit t(".save"), class: "button button__sm button__secondary" %>
        <%= link_to t(".cancel"), settings_path, class: "button button__sm button__transparent-secondary" %>
      </div>
    </div>
  </div>
<% end %>

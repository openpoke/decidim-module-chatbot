<%= decidim_form_for(@form, url: setting_path(id: params[:id]), method: :patch, html: { class: "form-defaults form edit_setting" }) do |form| %>
  <div class="form__wrapper"
       data-controller="chatbot-settings"
       data-chatbot-settings-components-url-value="<%= components_setting_path(id: params[:id]) %>"
       data-chatbot-settings-loading-text-value="<%= t('.loading') %>"
       data-chatbot-settings-select-component-text-value="<%= t('.select_component') %>"
       data-chatbot-settings-select-space-first-text-value="<%= t('.select_space_first') %>"
       data-chatbot-settings-configuration-for-text-value="<%= t('.configuration_for', workflow: '%{workflow}') %>">
    <% workflow_name = @form.workflow_display_name %>

    <div class="card pt-4">
      <div class="card-section">
        <div class="row column">
          <%= form.select :start_workflow,
              @form.available_workflows,
              { label: t(".current_workflow", provider: provider) },
              { data: { action: "change->chatbot-settings#updateWorkflowTitle" } } %>
        </div>
      </div>

      <div class="card-divider">
        <h2 class="card-title" data-chatbot-settings-target="workflowHeading">
          <%= t(".configuration_for", workflow: workflow_name) %>
        </h2>
      </div>

      <div class="card-section">
        <div class="row column">
          <%= form.select :participatory_space_gid,
              @form.available_spaces,
              { include_blank: t(".select_space"), label: t(".participatory_space") },
              { data: { action: "change->chatbot-settings#loadComponents", chatbot_settings_target: "spaceSelect" } } %>
        </div>

        <div class="row column" data-chatbot-settings-target="componentsWrapper" style="<%= @form.participatory_space.blank? ? 'display:none;' : '' %>">
          <%= form.select :component_id,
              @form.available_components,
              { include_blank: t(".select_component"), label: t(".component") },
              { data: { chatbot_settings_target: "componentSelect" } } %>
        </div>
      </div>
    </div>

    <div class="item__edit-sticky">
      <div class="item__edit-sticky-container">
        <%= form.submit t(".save"), class: "button button__sm button__secondary" %>
        <%= link_to t(".cancel"), settings_path, class: "button button__sm button__transparent-secondary" %>
      </div>
    </div>
  </div>
<% end %>
